
TODO
        
        
    [x] Bug: lost some document changes with recent server stop and reboot    
    
    [x] Spotify keeps trying to reload
    
    [ ] Spotify API needs to be on the server
        [ ] Widget does api/spotify/widgetid/login
        [ ] Server replies with redirect URL to be executed on the client
        [ ] User logs in
        [ ] Spotify sends credentials to server
        [ ] Server remembers accesstoken under the widget id
        [ ] Server gets the playstate and sends an update message to clients
        [ ] Client sends play commands to server
        [ ] Server forwards commands to spotify
        [ ] After sending command, Server re-requests state and forwards to clients
            - Clients keep widget state as transient values
        [ ] Keep spotify secrets in the config
        [ ] Get new secrets for spotify API and weather watcher
        
    [ ] put secrets in a config file called secrets.env
        - Weather API
        [ ] Make a template file for secrets

    [ ] Weather watcher
        [ ] Weather server:  https://openweathermap.org/api  (API key is a secret)
        - include space weather http://sws-data.sws.bom.gov.au/
    [ ] Perfect Pencil

NEW
    [ ] On the server, periodically purge empty folders and 0-length files
    [ ] google-like ajax functionality  in the search tool
        - Remember user searches on the widget
        - Do a background search 
    [ ] Add a scalable option to put the side inside a page scaler
    [ ] Perf: components that are expensive to evaluate:
        PageControl - 27ms
            Combobox 5.6
            widgetConfigurator 4 ms
        loadWidgetContent - 15 ms serial!
        Web sockets seem to load multiple times
        AppStyles.module.css - 3ms
        TinyMCE is just super expesive
            - Keeps loading .css files
            - keeps loading a bunch of plugins
            - Theme loading was 100ms!!!
    [ ] Perf Mobx is expensive (~100ms to render from widget updates)
        https://medium.com/workday-engineering/react-performance-and-mobx-b038085ecb72
        [ ] For batching:
            Batch the loading of content into holder objects, then assign them all in the same action
        [ ] don't create object and lambas in the react compenent declarations
        [ ] Avoid looking at properties of observables until the last second.  eg, avoid this:
            <Mycomponent somevalue={myObservable.value} />
    [ ] Perf Network
        
        

WIDGET IDEAS
    - Movie widget - in one search: common sense, imbd, rotten tomatoes, youtube trailer
        - Occasionally suggest movies and let you mark them for later
        - APIS:
            https://www.commonsensemedia.org/developers/api
            https://developer.imdb.com/
            https://developer.fandango.com/rotten_tomatoes
            https://developers.google.com/youtube/v3
            
            
            
    - frequent links
    - Archive
    - See recent bookmarks
    - Weather watcher
    - Scribble notes (perfect pencil)
    - Stacked TODO
    - Alfred TODO
        - Right-click->Add to TODO   puts link straight to todo widtget
    - Rule-base homepage:  Work page shows from 8am-5pm M-F
    - Ping tester - ping known locations around the world
    - Abacus
    - Real-time growing plant
    - Slowly changing background
    - Stock watcher
        - https://rapidapi.com/blog/best-stock-api/
    - Analytics watcher
        - Google analytics https://developers.google.com/analytics/devguides/reporting/core/v4/quickstart/web-js
    - Message watcher
    - Spotify tool
    - Finance watcher
        https://plaid.com/
    - Form Widget - Point it to a URL and it will find the forms
    - Pictaurus - File access through server
    - You know, the server can open links for you in the shell

IMPORTANT
   
BACKLOG
    [ ] Spotify https://levelup.gitconnected.com/how-to-build-a-spotify-player-with-react-in-15-minutes-7e01991bc4b6 
        - ClientID: 13d57354b3ce489bbf2dc93f67f7701d
        https://developer.spotify.com/documentation/
        https://developer.spotify.com/console/player/
        https://developer.spotify.com/documentation/general/guides/scopes/
        [ ] Quiz mode
            [ ] Need a way to store personal data on the server
                - For now, just store the data on the appmodel cache
            [ ] Show Artist: ??? - click to guess
                - will need to load playlist first
                - If not playlist, no guess mode
            [ ] Show title: ???
            [ ] Show % correct for last 10 guesses
            [ ] Once 100%, then just show the artist with a little button to put them back in quiz mode
    [ ] Hovering over links should show url
    [ ] Make it work across machines
        [ ] Watch for file changes: https://thisdavej.com/how-to-watch-for-files-changes-in-node-js/
        [ ] A connected client has a visible page + widgets
        [ ] Push an update to the client any page or widgets change
    [ ] should not try to save any content with null data
    [ ] Clean up the scroll bars on the editor area so they are smaller and less clunky

MAYBE NEVER
    [ ] Local caching to make the page keep working when the server is offline
        - Highest Write ID wins - should be easy to do this if the server is caching too
    [ ] React Service Runner? (Question on reddit)
    [ ] Start with a smaller window height and expand as items get close to the bottom
    [ ] Link tooltip with options
        - Edit link
        - Open in new tap
        - open in popup
        - delete
        - See stats
    [ ] Try to protect file accesses on the server
    [ ] Ping server regularly to decide if you should reconnect
    [ ] Server should periodically destry unreferenced widgets
        - Load all the pages, Figure out widget ids from the file system
        - Delete any widgets that never appear in the page text
    [ ] Would be nice to put forms into editor and have them work
        - Maybe just override keydown, but we need to not update the widget when editing the form






-- DONE ---------------------------------------------------------------------

Version 0.2/0.2
    [x] Intercept Ctrl-S on the page to prevent accidentally trying to save it
    [x] Define my own search engine
    [x] Spotify widget
        [x] Play/pause
        [x] seek forward/back
        [x] Skip next/prev


    [x] Cache pages on the server 
        - Only save page to disk if they haven't been touched for a minute  
            or if the server is going down
        - Keep versions and never overwrite
    [x] Cache pages on the client   
        [x] Set up a local store for page and widget access
        [x] At first, load everything from Cache
        [x] Fix problems
            - Version you save is actually wrong - don't serialize it
            - Mark the version as -1 to signal that you are in the middle of saving the page
                or maybe use setTimeout on the server to send the updates
                or maybe just both
        [x] pass the page widget list to server and get all the versions
        [x] For each widget, if the version is newer, load from the server

    [x] Widget settings should be a full sized dialog off to the side of the widget
    [x] Search widget 
        - when the input is blank, show grey placeholder text to identify the search
        - Clicking on a blank input shows a search dropdown to pick from
    [x] Bug: Drag area is invisible
    [x] Visual Replace borders with whitespace
    [x] Hide editor garbage until loaded
    [x] Bullet auto text does not always work:
    [x] Soften borders
    [x] Bug:  '* ' at the front of a line of links removes to end of the line
    [x] Add a few more color schemes             https://color.adobe.com/search?q=most-popular
        - Need to have better color choices
        - choices should be pure colors without values

    [x] Make links clickable
    [x] Color Theme picker
    [x] Google search
    
    [x] On window resize, move the settings gear to the corner
    [x] Page settings dropdowns have stopped working
    [x] Search widget needs a new default color
    [x] Text editor is busted - cursor keeps going to the start
    [x] Clean up scroll bars in general
    [x] Editor should be called "Rich Text"
    
    [x] Dragging richtext containers does not work so well
    [x] Search dropdown: use theme colors
    [x] Text editor: use theme color
    [x] Widget Color picker
        - Theme color
        - use an X button
        - make buttons smaller
    [x] Thesaurus/rhymes
    [x] Inside Adobe

    [x] Delete a widget
    [x] Save text widget
        - widgets are saved in their own files
    [x] Reload text widget with page
    [x] When editing a widget, periodically save it
        
    [x] Text widget editing is allll wonky
        - probably because the initial value is calculated from body, which is observable
    [x] Resize corner shows the wrong mouse pointer
    [x] Set up text editing with tinymce
        Account: ericjorg@thejcrew.net 22cowborgsInvading
    [x] Auto completer for bullets: https://stackoverflow.com/questions/68564653/tinymce-how-to-auto-convert-text-to-a-bullet-when-user-types/68570784#68570784
    [x] Resize the tinymce editor when the widget resizes
    [x] Tab to indent text
    
    [x] Sometimes there are collisions trying to save a widget
        - don't try to actually save on page load - recompiling can cause many pages to reload
        - Overall, there should be zero storage calls on a page reload
        
        
    [x] Use web sockets to push update notifications to clients
    
    [x] Bug: page is not property reloading when another client changes their page
        [x] Widget details should not be on the widget at all.  
            The App should keep track of all the widgets in a map that is 
            updated separately. 
        [x] Widget should reference page, not app
        - Data is making it over, but mobx is not signalling a reload (does not appear to be related to tinymce)
        - Somehow a widget update is touching the x,y,width,height properties
    [x] Bug: page should not reload if you were the one changing the page
    [x] Page should auto-refresh when changes are detected on the server
        - Use websockets to push
        - Check every minute that websocket is still up
    [x] Should not be able to change a widget's type
    
    
    
    
    [x] Formatting tweaks
        [x] Trim up margins
        [x] 5-color palette scheme with pastel backgrounds
            https://color.adobe.com/search?q=most-popular
                #020659
                #D9B504
                #D97904
                #BF0404
                #590202
    [x] Only move the item if we drag in the move handle
    [x] WSIWIG Editor
    [x] New Widget: Default to widget picker
    [x] General page saving
    [x] Should not try to save the page at all when refreshing
    [x] Remember grid setup
    [x] Title pad for each widget
    
    [x] React grid layout: https://www.npmjs.com/package/react-grid-layout
        [x] Add new grid items
        [x] compact on column
        [x] Instead of a click - drag an area
        
        
        
